(function(t){function e(e){for(var r,c,i=e[0],u=e[1],s=e[2],f=0,d=[];f<i.length;f++)c=i[f],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);l&&l(e);while(d.length)d.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,i=1;i<n.length;i++){var u=n[i];0!==o[u]&&(r=!1)}r&&(a.splice(e--,1),t=c(c.s=n[0]))}return t}var r={},o={app:0},a=[];function c(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=t,c.c=r,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)c.d(n,r,function(e){return t[e]}.bind(null,r));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var s=0;s<i.length;s++)e(i[s]);var l=u;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0429":function(t,e,n){"use strict";var r=n("504d"),o=n.n(r);o.a},"1be5":function(t,e,n){"use strict";var r=n("72e7"),o=n.n(r);o.a},"20b4":function(t,e,n){},"504d":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Header"),n("router-view")],1)},a=[],c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-navbar",{attrs:{toggleable:"lg",type:"dark",variant:"info"}},[n("b-navbar-brand",{attrs:{href:"#",to:"/dashboard"}},[t._v("VueCart")]),n("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),n("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[n("b-navbar-nav",{staticClass:"ml-auto"},[t.list.length>0?n("b-nav-item",{attrs:{href:"#"}},[n("b-icon-archive-fill"),t._v("Cart "),n("b-badge",{attrs:{variant:"light"}},[t._v(t._s(t.list.length))])],1):t._e(),t.profile.email?n("b-nav-item-dropdown",{attrs:{right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[t._v(" "+t._s(t.profile.email)+" ")]},proxy:!0}],null,!1,3921351691)},[n("b-dropdown-item",{attrs:{href:"#"}},[t._v("Total : "+t._s(t.total))]),n("b-dropdown-item",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.logout(e)}}},[t._v("Sign Out")])],1):t._e()],1)],1)],1)],1)},i=[],u=(n("13d5"),new r["default"]),s={setToken:function(t){localStorage.setItem("access_token",t)},getToken:function(){return localStorage.getItem("access_token")},isAuthenticated:function(){return!!localStorage.getItem("access_token")},removeToken:function(){localStorage.removeItem("access_token")},setProfile:function(t){u.$emit("loggedIn",t),localStorage.setItem("user",JSON.stringify(t))},getProfile:function(){return localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):{}},logout:function(){localStorage.removeItem("user"),localStorage.removeItem("access_token"),u.$emit("loggedIn",{})}},l=n("8c4f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container mt-5"},[n("div",{staticClass:"row wrapper"},t._l(t.products,(function(e){return n("b-card",{key:e.id,staticClass:"mb-4 mx-2",staticStyle:{"max-width":"20rem"},attrs:{title:e.name,"img-src":"https://picsum.photos/600/300/?image="+e.id,"img-alt":"Image","img-top":"",tag:"article"}},[n("b-card-text",[t._v(" Some quick example text to build on the card title and make up the bulk of the card's content. ")]),n("b-card-text",[n("strong",[t._v("$"+t._s(e.cost))])]),n("b-button",{attrs:{variant:"primary"},on:{click:function(n){return t.addToCart(e)}}},[t._v("Cart")])],1)})),1)])},d=[],p=(n("caad"),n("d3b7"),n("2532"),n("bc3a")),g=n.n(p),m={baseURL:"http://localhost:3000/"},b=g.a.create(m),v=function(t){if(console.log("authInterceptor:",t),t.url.includes("login"))return t;var e=s.getToken();return t.baseURL="".concat(t.baseURL,"api/"),t.headers.Authorization="Bearer ".concat(e),t};b.interceptors.request.use(v),b.interceptors.response.use((function(t){return console.log("response interceptors",t),t}),(function(t){return console.log("response interceptors",t),Promise.reject(t)}));var h=b,_="/products",w={getAll:function(){return h.get("".concat(_))},get:function(t){return h.get("".concat(_,"/").concat(t))},create:function(t){return h.post("".concat(_),t)}},k="/users",y="/auth/login",x={getAlls:function(){return h.get("".concat(k))},get:function(t){return h.get("".concat(k,"/").concat(t))},create:function(t){return h.post("".concat(k),t)},signIn:function(t){var e=t.email,n=t.password;return h.post("".concat(y),{email:e,password:n})}},S={products:w,users:x},O={get:function(t){return S[t]}},I=O.get("users"),j=O.get("products"),C={name:"Dashboard",data:function(){return{products:[]}},methods:{addToCart:function(t){u.$emit("CART_ADD",t)}},beforeCreate:function(){var t=this,e=s.getProfile();e.id?I.get(e.id).then((function(t){console.log("res:",t),s.setProfile(t.data)})):s.logout(),j.getAll().then((function(e){t.products=e.data}))}},P=C,A=(n("1be5"),n("2877")),T=Object(A["a"])(P,f,d,!1,null,"07ff8582",null),$=T.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login-container container"},[n("b-form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[n("b-form-group",{attrs:{id:"input-group-1"}},[n("b-form-input",{attrs:{id:"input-1",type:"email",required:"",placeholder:"Email"},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),n("b-form-group",{attrs:{id:"input-group-2"}},[n("b-form-input",{attrs:{id:"input-2",required:"",placeholder:"Password"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),n("b-button",{attrs:{block:"",type:"submit",variant:"info"}},[t._v("Submit")])],1)],1)},R=[],q=(n("96cf"),n("1da1")),E=O.get("users"),J={name:"Login",data:function(){return{form:{email:"",password:""}}},methods:{login:function(){var t=this;return Object(q["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,E.signIn(t.form);case 2:n=e.sent,n.data&&n.data&&(console.log("res.data:",n.data),s.setToken(n.data.access_token),s.setProfile(n.data.user),N.push("dashboard"));case 4:case"end":return e.stop()}}),e)})))()}}},L=J,M=(n("73e9"),Object(A["a"])(L,D,R,!1,null,"e6e13c02",null)),H=M.exports;r["default"].use(l["a"]);var U=new l["a"]({routes:[{path:"/dashboard",name:"dashboard",component:$,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:H},{path:"/",redirect:"/dashboard"}]});U.beforeEach((function(t,e,n){t.meta.requiresAuth?s.isAuthenticated()?n():n({name:"login"}):n()}));var N=U,z={name:"Header",data:function(){return{profile:{},list:[],total:0}},methods:{logout:function(){s.logout(),N.push("login")},calculate:function(){this.total=this.list.reduce((function(t,e){return t+e.cost}),0)}},beforeCreate:function(){var t=this;u.$on("loggedIn",(function(e){t.profile=e}))},mounted:function(){var t=this;u.$on("CART_ADD",(function(e){t.list.push(e),t.calculate()}))}},B=z,V=(n("0429"),Object(A["a"])(B,c,i,!1,null,"9cb401c0",null)),F=V.exports,G={name:"App",components:{Header:F}},K=G,Q=(n("5c0b"),Object(A["a"])(K,o,a,!1,null,null,null)),W=Q.exports,X=n("1e18"),Y=(n("f9e3"),n("2dd8"),n("b1e0"));r["default"].config.productionTip=!1,r["default"].use(X["a"]),r["default"].use(Y["a"]),new r["default"]({render:function(t){return t(W)},router:N}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var r=n("9c0c"),o=n.n(r);o.a},"72e7":function(t,e,n){},"73e9":function(t,e,n){"use strict";var r=n("20b4"),o=n.n(r);o.a},"9c0c":function(t,e,n){}});
//# sourceMappingURL=app.39993ac2.js.map